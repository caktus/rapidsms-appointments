{% extends "layout.html" %}
{% load url from future %}

{% load forms_tags %}
{% load django_tables2 %}

{% block stylesheets %}
{{ block.super }}
    <link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}appointments/stylesheets/appointments.css" />
{% endblock %}

{% block content %}
    <div class="span12" id="appointments">
        <div class="page-header"><h1>Appointment List</h1></div>
        <div class="row-fluid">
            <div class="span3">
                <form method="GET">
                    {% render_form form %}
                    <input class="btn btn-primary" type="submit" value="Update Filters" />
                    <a class="btn" href="{% url 'nutrition_reports' %}">Clear Filters</a>
                </form>
            </div>
            <div class="span9">
                {% if appts_table.data.queryset.exists %}
                    <p>
                        Displaying appointments {{ appts_table.page.start_index }} -
                        {{ appts_table.page.end_index }} of {{ appts_table.data.queryset.count }}.<br/>
                        {% url 'csv_appointment_list' as csv %}
                        {% if request.GET %}
                            <a href="{{ csv }}?{{ request.GET.urlencode }}">Export results as CSV</a>
                        {% else %}
                            <a href="{{ csv }}">Export results as CSV</a>
                        {% endif %}
                    </p>
                    {% render_table appts_table %}
                {% else %}
                    <p>No appointments match your query.</p>
                {% endif %}
            </div>
        </div>
    </div>
{% endblock content %}
